
jQuery.Class("OpenStreetMap_Map_Js",{},{container:false,mapInstance:false,selectedParams:false,setSelectedParams:function(a){this.selectedParams=a},registerMap:function(c,a){var b=L.map("mapid").setView(c,a);L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(b);this.mapInstance=b;return b},registerModalView:function(a){var d=jQuery.progressIndicator({position:a,blockInfo:{enabled:true}});this.container=a;var g=[0,0];var b=2;$("#mapid").css({height:500});var f=this.registerMap(g,b);var e={module:"OpenStreetMap",action:"GetMarkers",srcModule:app.getModuleName(),};$.extend(e,this.selectedParams);var c=[];AppConnector.request(e).then(function(h){d.progressIndicator({mode:"hide"});var i=h.result;i.forEach(function(k){c.push([k[0],k[1]]);var j=L.marker([k[0],k[1]],{icon:L.divIcon({className:"fa fa-map-marker fa-3x",})}).addTo(f).bindPopup(k[2]);j.valueOf()._icon.style.color=k.color});f.fitBounds(c)})},registerDetailView:function(a){this.container=a;var e=a.find("#coordinates").val();e=JSON.parse(e);var g=[0,0];var b=2;if(e.length){g=e[0];b=6}var f=$("#mapid").position();var c=$(".footerContainer ").position();$("#mapid").css({height:c.top-f.top-281});var d=this.registerMap(g,b);e.forEach(function(h){L.marker([h[0],h[1]]).addTo(d).bindPopup(h[2])})}});