
Settings_Vtiger_Index_Js("Settings_PBXManager_Index_Js",{},{saveAsteriskServerDetails:function(b){var a=this;var c=b.serializeFormData();var d=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});if(typeof c=="undefined"){c={}}c.module=app.getModuleName();c.parent=app.getParentModuleName();c.action="SaveAjax";AppConnector.request(c).then(function(f){if(f.success){var e=b.data("detailUrl");a.loadContents(e).then(function(g){d.progressIndicator({mode:"hide"});a.registerDetailViewEvents()},function(g,h){d.progressIndicator({mode:"hide"})})}else{d.progressIndicator({mode:"hide"});jQuery(".errorMessage",b).removeClass("hide")}},function(e,f){})},registerEditViewEvents:function(){var d=this;var c=jQuery("#MyModal");var a=jQuery(".cancelLink",c);var b="index.php?module=PBXManager&parent=Settings&action=Gateway&mode=getSecretKey";AppConnector.request(b).then(function(f){jQuery("input[name='vtigersecretkey']").attr("value",f.result)});var e=app.validationEngineOptions;e.onValidationComplete=function(g,f){if(f){d.saveAsteriskServerDetails(g);return f}};c.validationEngine(e);c.submit(function(f){f.preventDefault()});a.click(function(h){var f=c.data("detailUrl");var g=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});d.loadContents(f).then(function(i){g.progressIndicator({mode:"hide"});d.registerDetailViewEvents()},function(i,j){g.progressIndicator({mode:"hide"})})})},registerDetailViewEvents:function(){var b=this;var a=jQuery("#AsteriskServerDetails");var c=jQuery(".editButton",a);c.click(function(g){var d=jQuery(g.currentTarget).data("url");var f=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});b.loadContents(d).then(function(e){b.registerEditViewEvents();f.progressIndicator({mode:"hide"})},function(e,h){f.progressIndicator({mode:"hide"})})})},loadContents:function(b){var a=jQuery.Deferred();AppConnector.requestPjax(b).then(function(c){jQuery(".contentsDiv").html(c);a.resolve(c)},function(c,d){a.reject()});return a.promise()},registerEvents:function(){var a=this;a.registerDetailViewEvents()}});jQuery(document).ready(function(b){var a=new Settings_Vtiger_Index_Js();a.registerEvents()});