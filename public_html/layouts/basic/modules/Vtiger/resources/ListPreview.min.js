
Vtiger_List_Js("Vtiger_ListPreview_Js",{},{frameProgress:false,updatePreview:function(a){var c=$(".listPreviewframe");this.frameProgress=$.progressIndicator({position:"html",message:app.vtranslate("JS_FRAME_IN_PROGRESS"),blockInfo:{enabled:true}});var b="";if(app.getMainParams("defaultDetailViewName")){b=b+"&mode=showDetailViewByMode&requestMode="+app.getMainParams("defaultDetailViewName")}c.attr("src",a.replace("view=Detail","view=DetailPreview")+b)},registerPreviewEvent:function(){const b=this;const a=$(".listPreviewframe");$(".listPreviewframe").load(function(){const c=b.getListViewContentContainer();b.frameProgress.progressIndicator({mode:"hide"});a.height($(this).contents().find(".bodyContents").height()-20);b.toggleSplit(c);if($(window).width()>993){b.registerListEvents(c)}});$(".listViewEntriesTable .listViewEntries").first().trigger("click")},postLoadListViewRecordsEvents:function(a){this._super(a);this.registerPreviewEvent()},registerRowClickEvent:function(){var b=this;var a=this.getListViewContentContainer();a.on("click",".listViewEntries",function(d){if($(d.target).closest("div").hasClass("actions")){return}if($(d.target).is("button")||$(d.target).parent().is("button")){return}if($(d.target).closest("a").hasClass("noLinkBtn")){return}if($(d.target,$(d.currentTarget)).is("td:first-child")){return}if($(d.target).is('input[type="checkbox"]')){return}if($.contains($(d.currentTarget).find("td:last-child").get(0),d.target)){return}if($.contains($(d.currentTarget).find("td:first-child").get(0),d.target)){return}var c=$(d.currentTarget);var f=c.data("recordurl");if(typeof f=="undefined"){return}d.preventDefault();$(".listViewEntriesTable .listViewEntries").removeClass("active");$(this).addClass("active");b.updatePreview(f)})},registerListEvents:function(a){var e=a.find(".fixedListInitial");var h=a.find(".listPreview");var c=a.closest(".mainBody");var d=a.find(".wrappedPanel");var i=a.find(".listViewEntriesDiv");var f=$(".commonActionsContainer").height();var g=6;var b=e.offset().top-f-g;app.showNewBottomTopScrollbar(a.find(".fixedListContent"));app.showNewLeftScrollbar(e);$(window).resize(function(){if(c.scrollTop()>=(e.offset().top+f)){a.find(".gutter").css("left",h.offset().left-8)}});c.scroll(function(){var k=a.find(".gutter");var j={height:$(window).height()-(k.offset().top+33)};k.css(j);e.css(j);d.css(j);if($(this).scrollTop()>=(e.offset().top+f-g)){if(h.height()+h.offset().top+33>$(window).height()){e.css("top",$(this).scrollTop()-b);if($(window).width()>993){d.addClass("wrappedPanelOnScroll");k.addClass("gutterOnScroll");k.css("left",h.offset().left-8);k.on("mousedown",function(){$(this).on("mousemove",function(l){$(this).css("left",h.offset().left-8)})})}}}else{e.css("top","initial");if($(window).width()>993){var k=a.find(".gutter");d.removeClass("wrappedPanelOnScroll");k.removeClass("gutterOnScroll");k.css("left",0);k.off("mousedown");k.off("mousemove")}}})},registerSplit:function(a){var j=this;var e=(400/$(window).width())*100;var i=a.find(".listViewEntriesDiv .listViewHeaders th").first();i=((i.width()+i.next().width()+62)/$(window).width())*100;var g=a.find(".fixedListInitial");var l=a.find(".wrappedPanel");var c=a.find(l[0]);var b=a.find(l[1]);var h=Split([".fixedListInitial",".listPreview"],{sizes:[i,100-i],minSize:10,gutterSize:8,snapOffset:100,onDrag:function(){if(h.getSizes()[1]<e){h.collapse(1)}if(h.getSizes()[0]<5){c.addClass("wrappedPanelLeft")}else{c.removeClass("wrappedPanelLeft")}if(h.getSizes()[1]<10){b.addClass("wrappedPanelRight");g.width(g.width()-10)}else{b.removeClass("wrappedPanelRight")}}});var d=a.find(".gutter");var f={height:$(window).height()-(d.offset().top+33)};var k=a.find(".rotatedText");d.css(f);g.css(f);l.css(f);j.registerSplitEvents(a,h);k.first().find(".textCenter").append($(".breadcrumbsContainer .separator").nextAll().text());k.css({width:c.height(),height:c.height()});return h},registerSplitEvents:function(b,g){var e=b.find(".gutter");var f=b.find(".fixedListInitial");var i=b.find(".wrappedPanel");var d=b.find(i[0]);var c=b.find(i[1]);var a=(15/$(window).width())*100;var h=100-a;e.on("dblclick",function(){if(g.getSizes()[0]<25){g.setSizes([25,75]);d.removeClass("wrappedPanelLeft")}else{if(g.getSizes()[1]<25){g.setSizes([75,25]);c.removeClass("wrappedPanelRight");e.css("right","initial");f.css("padding-right","10px")}else{if(g.getSizes()[0]>24&&g.getSizes()[0]<50){g.setSizes([a,h]);d.addClass("wrappedPanelLeft")}else{if(g.getSizes()[1]>10&&g.getSizes()[1]<50){g.collapse(1);c.addClass("wrappedPanelRight");f.width(f.width()-10)}}}}});d.on("dblclick",function(){g.setSizes([25,75]);d.removeClass("wrappedPanelLeft")});c.on("dblclick",function(){g.setSizes([75,25]);c.removeClass("wrappedPanelRight");e.css("right","initial");f.css("padding-right","10px")})},toggleSplit:function(a){var h=this;var f=a.find(".fixedListInitial");var i=a.find(".listPreview");var d=[];var e=a.closest(".mainBody");var c=$(".wrappedPanel")[0];c=a.find(c);var b=$(".wrappedPanel")[1];b=a.find(b);if($(window).width()>993){var g=h.registerSplit(a);d.push(g)}$(window).resize(function(){if($(window).width()<993){if(a.find(".gutter").length){d[d.length-1].destroy();b.removeClass("wrappedPanelRight");c.removeClass("wrappedPanelLeft")}}else{if(a.find(".gutter").length!==1){var l=h.registerSplit(a);var n=a.find(".gutter");if(e.scrollTop()>=(f.offset().top)){n.addClass("gutterOnScroll");n.css("left",i.offset().left-8);n.on("mousedown",function(){$(this).on("mousemove",function(o){$(this).css("left",i.offset().left-8)})})}d.push(l)}var j=d[d.length-1];var k=(15/$(window).width())*100;var m=100-k;if(j.getSizes()[0]<k+5){j.setSizes([k,m])}else{if(j.getSizes()[1]<k+5){j.setSizes([m,k])}}}})},updateWindowHeight:function(a,b){b.height(a)},registerEvents:function(){this._super();this.registerPreviewEvent()}});